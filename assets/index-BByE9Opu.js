(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function a(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=a(s);fetch(s.href,o)}})();const g=JSON.parse('[{"prodid":"-//1823 Contact Centre, HKSARG//Hong Kong Public Holidays//EN","version":"2.0","calscale":"GREGORIAN","x-wr-timezone":"Asia/Hong_Kong","x-wr-calname":"Hong Kong Public Holidays","x-wr-caldesc":"Hong Kong Public Holidays","vevent":[{"dtstart":["20240101",{"value":"DATE"}],"dtend":["20240102",{"value":"DATE"}],"dtstamp":"20250506T032740Z","transp":"TRANSPARENT","uid":"20240101@1823.gov.hk","summary":"The first day of January"},{"dtstart":["20240210",{"value":"DATE"}],"dtend":["20240211",{"value":"DATE"}],"dtstamp":"20250506T032740Z","transp":"TRANSPARENT","uid":"20240210@1823.gov.hk","summary":"Lunar New Year’s Day"},{"dtstart":["20240212",{"value":"DATE"}],"dtend":["20240213",{"value":"DATE"}],"dtstamp":"20250506T032740Z","transp":"TRANSPARENT","uid":"20240212@1823.gov.hk","summary":"The third day of Lunar New Year"},{"dtstart":["20240213",{"value":"DATE"}],"dtend":["20240214",{"value":"DATE"}],"dtstamp":"20250506T032740Z","transp":"TRANSPARENT","uid":"20240213@1823.gov.hk","summary":"The fourth day of Lunar New Year"},{"dtstart":["20240329",{"value":"DATE"}],"dtend":["20240330",{"value":"DATE"}],"dtstamp":"20250506T032740Z","transp":"TRANSPARENT","uid":"20240329@1823.gov.hk","summary":"Good Friday"},{"dtstart":["20240330",{"value":"DATE"}],"dtend":["20240331",{"value":"DATE"}],"dtstamp":"20250506T032740Z","transp":"TRANSPARENT","uid":"20240330@1823.gov.hk","summary":"The day following Good Friday"},{"dtstart":["20240401",{"value":"DATE"}],"dtend":["20240402",{"value":"DATE"}],"dtstamp":"20250506T032740Z","transp":"TRANSPARENT","uid":"20240401@1823.gov.hk","summary":"Easter Monday"},{"dtstart":["20240404",{"value":"DATE"}],"dtend":["20240405",{"value":"DATE"}],"dtstamp":"20250506T032740Z","transp":"TRANSPARENT","uid":"20240404@1823.gov.hk","summary":"Ching Ming Festival"},{"dtstart":["20240501",{"value":"DATE"}],"dtend":["20240502",{"value":"DATE"}],"dtstamp":"20250506T032740Z","transp":"TRANSPARENT","uid":"20240501@1823.gov.hk","summary":"Labour Day"},{"dtstart":["20240515",{"value":"DATE"}],"dtend":["20240516",{"value":"DATE"}],"dtstamp":"20250506T032740Z","transp":"TRANSPARENT","uid":"20240515@1823.gov.hk","summary":"The Birthday of the Buddha"},{"dtstart":["20240610",{"value":"DATE"}],"dtend":["20240611",{"value":"DATE"}],"dtstamp":"20250506T032740Z","transp":"TRANSPARENT","uid":"20240610@1823.gov.hk","summary":"Tuen Ng Festival"},{"dtstart":["20240701",{"value":"DATE"}],"dtend":["20240702",{"value":"DATE"}],"dtstamp":"20250506T032740Z","transp":"TRANSPARENT","uid":"20240701@1823.gov.hk","summary":"Hong Kong Special Administrative Region Establishment Day"},{"dtstart":["20240918",{"value":"DATE"}],"dtend":["20240919",{"value":"DATE"}],"dtstamp":"20250506T032740Z","transp":"TRANSPARENT","uid":"20240918@1823.gov.hk","summary":"The day following the Chinese Mid-Autumn Festival"},{"dtstart":["20241001",{"value":"DATE"}],"dtend":["20241002",{"value":"DATE"}],"dtstamp":"20250506T032740Z","transp":"TRANSPARENT","uid":"20241001@1823.gov.hk","summary":"National Day"},{"dtstart":["20241011",{"value":"DATE"}],"dtend":["20241012",{"value":"DATE"}],"dtstamp":"20250506T032740Z","transp":"TRANSPARENT","uid":"20241011@1823.gov.hk","summary":"Chung Yeung Festival"},{"dtstart":["20241225",{"value":"DATE"}],"dtend":["20241226",{"value":"DATE"}],"dtstamp":"20250506T032740Z","transp":"TRANSPARENT","uid":"20241225@1823.gov.hk","summary":"Christmas Day"},{"dtstart":["20241226",{"value":"DATE"}],"dtend":["20241227",{"value":"DATE"}],"dtstamp":"20250506T032740Z","transp":"TRANSPARENT","uid":"20241226@1823.gov.hk","summary":"The first weekday after Christmas Day"},{"dtstart":["20250101",{"value":"DATE"}],"dtend":["20250102",{"value":"DATE"}],"dtstamp":"20250506T035044Z","transp":"TRANSPARENT","uid":"20250101@1823.gov.hk","summary":"The first day of January"},{"dtstart":["20250129",{"value":"DATE"}],"dtend":["20250130",{"value":"DATE"}],"dtstamp":"20250506T035044Z","transp":"TRANSPARENT","uid":"20250129@1823.gov.hk","summary":"Lunar New Year’s Day"},{"dtstart":["20250130",{"value":"DATE"}],"dtend":["20250131",{"value":"DATE"}],"dtstamp":"20250506T035044Z","transp":"TRANSPARENT","uid":"20250130@1823.gov.hk","summary":"The second day of Lunar New Year"},{"dtstart":["20250131",{"value":"DATE"}],"dtend":["20250201",{"value":"DATE"}],"dtstamp":"20250506T035044Z","transp":"TRANSPARENT","uid":"20250131@1823.gov.hk","summary":"The third day of Lunar New Year"},{"dtstart":["20250404",{"value":"DATE"}],"dtend":["20250405",{"value":"DATE"}],"dtstamp":"20250506T035044Z","transp":"TRANSPARENT","uid":"20250404@1823.gov.hk","summary":"Ching Ming Festival"},{"dtstart":["20250418",{"value":"DATE"}],"dtend":["20250419",{"value":"DATE"}],"dtstamp":"20250506T035044Z","transp":"TRANSPARENT","uid":"20250418@1823.gov.hk","summary":"Good Friday"},{"dtstart":["20250419",{"value":"DATE"}],"dtend":["20250420",{"value":"DATE"}],"dtstamp":"20250506T035044Z","transp":"TRANSPARENT","uid":"20250419@1823.gov.hk","summary":"The day following Good Friday"},{"dtstart":["20250421",{"value":"DATE"}],"dtend":["20250422",{"value":"DATE"}],"dtstamp":"20250506T035044Z","transp":"TRANSPARENT","uid":"20250421@1823.gov.hk","summary":"Easter Monday"},{"dtstart":["20250501",{"value":"DATE"}],"dtend":["20250502",{"value":"DATE"}],"dtstamp":"20250506T035044Z","transp":"TRANSPARENT","uid":"20250501@1823.gov.hk","summary":"Labour Day"},{"dtstart":["20250505",{"value":"DATE"}],"dtend":["20250506",{"value":"DATE"}],"dtstamp":"20250506T035044Z","transp":"TRANSPARENT","uid":"20250505@1823.gov.hk","summary":"The Birthday of the Buddha"},{"dtstart":["20250531",{"value":"DATE"}],"dtend":["20250601",{"value":"DATE"}],"dtstamp":"20250506T035044Z","transp":"TRANSPARENT","uid":"20250531@1823.gov.hk","summary":"Tuen Ng Festival"},{"dtstart":["20250701",{"value":"DATE"}],"dtend":["20250702",{"value":"DATE"}],"dtstamp":"20250506T035044Z","transp":"TRANSPARENT","uid":"20250701@1823.gov.hk","summary":"Hong Kong Special Administrative Region Establishment Day"},{"dtstart":["20251001",{"value":"DATE"}],"dtend":["20251002",{"value":"DATE"}],"dtstamp":"20250506T035044Z","transp":"TRANSPARENT","uid":"20251001@1823.gov.hk","summary":"National Day"},{"dtstart":["20251007",{"value":"DATE"}],"dtend":["20251008",{"value":"DATE"}],"dtstamp":"20250506T035044Z","transp":"TRANSPARENT","uid":"20251007@1823.gov.hk","summary":"The day following the Chinese Mid-Autumn Festival"},{"dtstart":["20251029",{"value":"DATE"}],"dtend":["20251030",{"value":"DATE"}],"dtstamp":"20250506T035044Z","transp":"TRANSPARENT","uid":"20251029@1823.gov.hk","summary":"Chung Yeung Festival"},{"dtstart":["20251225",{"value":"DATE"}],"dtend":["20251226",{"value":"DATE"}],"dtstamp":"20250506T035044Z","transp":"TRANSPARENT","uid":"20251225@1823.gov.hk","summary":"Christmas Day"},{"dtstart":["20251226",{"value":"DATE"}],"dtend":["20251227",{"value":"DATE"}],"dtstamp":"20250506T035044Z","transp":"TRANSPARENT","uid":"20251226@1823.gov.hk","summary":"The first weekday after Christmas Day"},{"dtstart":["20260101",{"value":"DATE"}],"dtend":["20260102",{"value":"DATE"}],"dtstamp":"20250516T063710Z","transp":"TRANSPARENT","uid":"20260101@1823.gov.hk","summary":"The first day of January"},{"dtstart":["20260217",{"value":"DATE"}],"dtend":["20260218",{"value":"DATE"}],"dtstamp":"20250516T063710Z","transp":"TRANSPARENT","uid":"20260217@1823.gov.hk","summary":"Lunar New Year’s Day"},{"dtstart":["20260218",{"value":"DATE"}],"dtend":["20260219",{"value":"DATE"}],"dtstamp":"20250516T063710Z","transp":"TRANSPARENT","uid":"20260218@1823.gov.hk","summary":"The second day of Lunar New Year"},{"dtstart":["20260219",{"value":"DATE"}],"dtend":["20260220",{"value":"DATE"}],"dtstamp":"20250516T063710Z","transp":"TRANSPARENT","uid":"20260219@1823.gov.hk","summary":"The third day of Lunar New Year"},{"dtstart":["20260403",{"value":"DATE"}],"dtend":["20260404",{"value":"DATE"}],"dtstamp":"20250516T063710Z","transp":"TRANSPARENT","uid":"20260403@1823.gov.hk","summary":"Good Friday"},{"dtstart":["20260404",{"value":"DATE"}],"dtend":["20260405",{"value":"DATE"}],"dtstamp":"20250516T063710Z","transp":"TRANSPARENT","uid":"20260404@1823.gov.hk","summary":"The day following Good Friday"},{"dtstart":["20260406",{"value":"DATE"}],"dtend":["20260407",{"value":"DATE"}],"dtstamp":"20250516T063710Z","transp":"TRANSPARENT","uid":"20260406@1823.gov.hk","summary":"The day following Ching Ming Festival"},{"dtstart":["20260407",{"value":"DATE"}],"dtend":["20260408",{"value":"DATE"}],"dtstamp":"20250516T063710Z","transp":"TRANSPARENT","uid":"20260407@1823.gov.hk","summary":"The day following Easter Monday"},{"dtstart":["20260501",{"value":"DATE"}],"dtend":["20260502",{"value":"DATE"}],"dtstamp":"20250516T063710Z","transp":"TRANSPARENT","uid":"20260501@1823.gov.hk","summary":"Labour Day"},{"dtstart":["20260525",{"value":"DATE"}],"dtend":["20260526",{"value":"DATE"}],"dtstamp":"20250516T063710Z","transp":"TRANSPARENT","uid":"20260525@1823.gov.hk","summary":"The day following the Birthday of the Buddha"},{"dtstart":["20260619",{"value":"DATE"}],"dtend":["20260620",{"value":"DATE"}],"dtstamp":"20250516T063710Z","transp":"TRANSPARENT","uid":"20260619@1823.gov.hk","summary":"Tuen Ng Festival"},{"dtstart":["20260701",{"value":"DATE"}],"dtend":["20260702",{"value":"DATE"}],"dtstamp":"20250516T063710Z","transp":"TRANSPARENT","uid":"20260701@1823.gov.hk","summary":"Hong Kong Special Administrative Region Establishment Day"},{"dtstart":["20260926",{"value":"DATE"}],"dtend":["20260927",{"value":"DATE"}],"dtstamp":"20250516T063710Z","transp":"TRANSPARENT","uid":"20260926@1823.gov.hk","summary":"The day following the Chinese Mid-Autumn Festival"},{"dtstart":["20261001",{"value":"DATE"}],"dtend":["20261002",{"value":"DATE"}],"dtstamp":"20250516T063710Z","transp":"TRANSPARENT","uid":"20261001@1823.gov.hk","summary":"National Day"},{"dtstart":["20261019",{"value":"DATE"}],"dtend":["20261020",{"value":"DATE"}],"dtstamp":"20250516T063710Z","transp":"TRANSPARENT","uid":"20261019@1823.gov.hk","summary":"The day following Chung Yeung Festival"},{"dtstart":["20261225",{"value":"DATE"}],"dtend":["20261226",{"value":"DATE"}],"dtstamp":"20250516T063710Z","transp":"TRANSPARENT","uid":"20261225@1823.gov.hk","summary":"Christmas Day"},{"dtstart":["20261226",{"value":"DATE"}],"dtend":["20261227",{"value":"DATE"}],"dtstamp":"20250516T063710Z","transp":"TRANSPARENT","uid":"20261226@1823.gov.hk","summary":"The first weekday after Christmas Day"}]}]'),D={vcalendar:g};function N(){f(),B(),h(),i()}const d={deadline:null,tasks:[],dateFormat:"yyyy-MM-dd",skipHolidays:!0,holidays:[],holidaySet:new Set},n={tabButtons:document.querySelectorAll(".tab-btn"),tabContents:document.querySelectorAll(".tab-content"),dateFormatSelect:document.getElementById("date-format"),skipHolidaysCheckbox:document.getElementById("exclude-holidays"),holidayContainer:document.getElementById("holiday-items"),deadlineInput:document.getElementById("deadline"),setDeadlineBtn:document.getElementById("set-deadline"),deadlineDisplay:document.getElementById("deadline-display"),exportBtn:document.getElementById("export-btn"),importBtn:document.getElementById("import-btn"),importFile:document.getElementById("import-file"),taskSection:document.getElementById("task-section"),taskNameInput:document.getElementById("task-name"),taskDurationInput:document.getElementById("task-duration"),addTaskBtn:document.getElementById("add-task"),planTable:document.getElementById("plan-table"),planBody:document.getElementById("plan-body"),noTasksMsg:document.getElementById("no-tasks-msg")};function f(){n.tabButtons.forEach(t=>t.addEventListener("click",k)),n.dateFormatSelect.addEventListener("change",R),n.skipHolidaysCheckbox.addEventListener("change",S),n.setDeadlineBtn.addEventListener("click",P),n.addTaskBtn.addEventListener("click",Z),n.exportBtn.addEventListener("click",w),n.importBtn.addEventListener("click",F),n.importFile.addEventListener("change",b)}function k(t){const e=t.currentTarget.dataset.tab;n.tabButtons.forEach(a=>a.classList.toggle("active",a===t.currentTarget)),n.tabContents.forEach(a=>a.classList.toggle("active",a.id===`${e}-tab`))}function R(){d.dateFormat=n.dateFormatSelect.value,v(),h(),i()}function S(){d.skipHolidays=n.skipHolidaysCheckbox.checked,A(),i()}function P(){const t=n.deadlineInput.valueAsDate;if(!t)return alert("Please pick a valid date.");d.deadline=l(t),A(),v(),n.taskSection.style.display="block",i()}function Z(){const t=n.taskNameInput.value.trim(),e=parseInt(n.taskDurationInput.value,10);if(!t||isNaN(e)||e<1)return alert("Enter valid task name and duration.");d.tasks.push({name:t,duration:e}),n.taskNameInput.value="",n.taskDurationInput.value="",A(),i()}function w(){const t={deadline:d.deadline,tasks:d.tasks,dateFormat:d.dateFormat,skipHolidays:d.skipHolidays,exportDate:new Date().toISOString(),version:"1.0"},e=JSON.stringify(t,null,2),a=new Blob([e],{type:"application/json"}),r=URL.createObjectURL(a),s=document.createElement("a");s.href=r,s.download=`project-plan-${$(new Date)}.json`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)}function F(){n.importFile.click()}function b(t){const e=t.target.files[0];if(!e)return;const a=new FileReader;a.onload=function(r){try{const s=JSON.parse(r.target.result);L(s)}catch(s){alert("Error reading file: Invalid JSON format"),console.error("Import error:",s)}},a.readAsText(e),t.target.value=""}function L(t){if(!t||typeof t!="object"){alert("Invalid plan file format");return}try{t.deadline&&(d.deadline=new Date(t.deadline),n.deadlineInput.valueAsDate=d.deadline,v(),n.taskSection.style.display="block"),Array.isArray(t.tasks)&&(d.tasks=t.tasks.map(e=>({name:e.name||"Unnamed Task",duration:parseInt(e.duration)||1,startDate:e.startDate?new Date(e.startDate):null,endDate:e.endDate?new Date(e.endDate):null}))),t.dateFormat&&["yyyy-MM-dd","MM/dd/yyyy","dd MMM yyyy"].includes(t.dateFormat)&&(d.dateFormat=t.dateFormat,n.dateFormatSelect.value=t.dateFormat),typeof t.skipHolidays=="boolean"&&(d.skipHolidays=t.skipHolidays,n.skipHolidaysCheckbox.checked=t.skipHolidays),A(),i(),alert("Plan imported successfully!")}catch(e){alert("Error importing plan: "+e.message),console.error("Import error:",e)}}function B(){const t=D.vcalendar[0].vevent;d.holidays=t.map(e=>{const a=e.dtstart[0],r=new Date(+a.slice(0,4),+a.slice(4,6)-1,+a.slice(6,8));return{date:l(r),summary:e.summary}}),d.holidays.forEach(e=>d.holidaySet.add(+e.date))}function h(){n.holidayContainer.innerHTML="",d.holidays.forEach(({date:t,summary:e})=>{const a=document.createElement("div");a.className="holiday-item",a.innerHTML=`${m(t)} ${e}`,n.holidayContainer.appendChild(a)})}function A(){if(!d.deadline||d.tasks.length===0)return;let t=M(d.deadline);for(let e=d.tasks.length-1;e>=0;e--){const a=d.tasks[e];a.endDate=new Date(t),a.startDate=C(t,a.duration),e>0&&(t=I(a.startDate))}}function I(t){let e=y(t,-1);for(;u(e)||T(e);)e=y(e,-1);return l(e)}function M(t){let e=new Date(t);if(u(e)||T(e))for(;u(e)||T(e);)e=y(e,-1);return l(e)}function C(t,e){let a=e-1,r=new Date(t);for(;a>0;)r=y(r,-1),!u(r)&&!T(r)&&a--;return l(r)}function u(t){const e=t.getDay();return e===0||e===6}function T(t){return d.skipHolidays&&d.holidaySet.has(+l(t))}function i(){p(n.planTable,d.tasks.length>0&&d.deadline),n.noTasksMsg.textContent=d.deadline?d.tasks.length?"":"No tasks added yet.":"Please set a deadline first.",p(n.noTasksMsg,!d.tasks.length||!d.deadline),d.tasks.length&&d.deadline&&(n.planBody.innerHTML="",d.tasks.forEach(t=>n.planBody.appendChild(H(t))))}function H({name:t,startDate:e,endDate:a,duration:r}){const s=document.createElement("tr");return s.innerHTML=`
        <td>${t}</td>
        <td>${m(e)}</td>
        <td>${E(e)}</td>
        <td>${m(a)}</td>
        <td>${E(a)}</td>
        <td>${r}</td>
    `,s}function m(t){const e=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");switch(d.dateFormat){case"MM/dd/yyyy":return`${a}/${r}/${e}`;case"dd MMM yyyy":return`${r} ${t.toLocaleString(void 0,{month:"short"})} ${e}`;default:return`${e}-${a}-${r}`}}function E(t){return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][t.getDay()]}function y(t,e){const a=new Date(t);return a.setDate(a.getDate()+e),a}function l(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate())}function p(t,e){t.style.display=e?"":"none"}function v(){n.deadlineDisplay.textContent=d.deadline?"Deadline: "+m(d.deadline):""}function $(t){const e=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${e}-${a}-${r}`}document.addEventListener("DOMContentLoaded",()=>{N()});
